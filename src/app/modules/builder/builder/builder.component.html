<app-loading-notice class="mt-3" subject="Board Set" *ngIf="loading"></app-loading-notice>
<app-error-not-found class="container mt-3" subject="Board Set" *ngIf="loadingError"></app-error-not-found>
<div class="example-container" [class.example-is-mobile]="mobileQuery.matches" *ngIf="boardSet && !loading">

  <mat-sidenav-container class="example-sidenav-container"
                         [style.marginTop.px]="mobileQuery.matches ? 56 : 0"
                         [autosize]="true"
  >
    <mat-sidenav #sideNav [mode]="mobileQuery.matches ? 'over' : 'side'"
                 [fixedInViewport]="mobileQuery.matches" fixedTopGap="56"
                 [opened]="!mobileQuery.matches"

    >
      <div fxLayout="column" fxFlex>
        <div id="leftSidebarHeaderPanel" class="mat-elevation-z4">


          <div fxLayout="row" fxLayoutAlign="space-between center" (dblclick)="editBoardSet()">
            <h3 id="boardSetName">{{boardSet.name}}</h3>

            <button mat-button mat-icon-button
                    [matMenuTriggerFor]="matBoardSetMenu"
                    matTooltip="Board Set Actions" matTooltipPosition="right"
                    (click)="$event.stopPropagation()"
            >
              <mat-icon>more_vert</mat-icon>
            </button>
          </div>

          <div fxLayout="row" fxLayoutAlign="space-between center" *ngIf="boardSet?.readonly">
            <div class="read-only">Read Only</div>

            <button mat-button mat-icon-button (click)="copyBoardSet()"
                    matTooltip="Create Editable Copy" matTooltipPosition="right">
              <mat-icon>create</mat-icon>
            </button>
          </div>

        </div>

        <app-board-tree *ngIf="boardSet"
                        [boardSet]="boardSet"
                        [boards]="boardSet.boards"
                        [selectedBoard]="board"
                        (selectionChange)="selectBoard($event)"
                        (deleteBoard)="deleteBoard($event)"
                        (updateBoard)="loadBoardSet()"
                        fxFlex="grow"
                        style="overflow-y: scroll"
        >

        </app-board-tree>

        <div id="leftSidebarBottomPanel">
          <button mat-mini-fab
                  (click)="addBoard()"
                  [disabled]="boardSet?.readonly"
                  matTooltip="Add Board" matTooltipPosition="right" i18n-matTooltip
                  aria-label="Add Board" i18n-aria-label
                  color="primary" >
            <mat-icon>add</mat-icon>
          </button>
        </div>
      </div>



    </mat-sidenav>

    <mat-sidenav [opened]="selectedCell" mode="side" position="end" id="cellEditor" #cellEditor
                 (opened)="disableCellEditorAnimations = false"
                 (closed)="disableCellEditorAnimations = true; selectedCell = null"
                 *ngIf="!boardSet?.readonly">

      <app-cell-editor [boardSet]="boardSet"
                       [board]="board"
                       [cell]="selectedCell"
                       (closed)="cellEditor.close();"
                       (cellLinkedToBoard)="loadBoardSet()"
                       [@.disabled]="disableCellEditorAnimations"
      ></app-cell-editor>
    </mat-sidenav>

    <mat-sidenav-content>
      <app-board-detail [board]="board" [(cell)]="selectedCell" (boardChange)="selectBoard($event)"></app-board-detail>
    </mat-sidenav-content>
  </mat-sidenav-container>

  <div id="leftSidebarToggler" [class.open]="sideNav.opened">
    <button mat-mini-fab color="primary" (click)="sideNav.toggle()" [matTooltip]="(sideNav.opened ? 'Hide' : 'Show') + ' Boards Panel'" matTooltipPosition="right" class="mat-elevation-z2">
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>
</div>

<mat-menu #matBoardSetMenu="matMenu">
  <button mat-menu-item (click)="uploadBoardObf()" [disabled]="boardSet?.readonly">
    <mat-icon>insert_drive_file</mat-icon> <ng-container i18n>Add Board from OBF</ng-container>
  </button>
  <button mat-menu-item (click)="downloadBoardSetObz()">
    <mat-icon>save_alt</mat-icon> <ng-container i18n>Download Board Set as OBZ</ng-container>
  </button>

  <mat-divider></mat-divider>

  <button mat-menu-item (click)="null" [disabled]="boardSet?.readonly">
    <mat-icon>delete</mat-icon> Delete
  </button>

  <button mat-menu-item (click)="editBoardSet()" [disabled]="boardSet?.readonly">
    <mat-icon>edit</mat-icon> Properties
  </button>
</mat-menu>


<hotkeys-cheatsheet title="Keyboard Shortcuts" ></hotkeys-cheatsheet>
